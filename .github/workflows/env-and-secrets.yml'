name: Env and Secrets Demo

on:
  workflow_dispatch:

env:
  AWS_REGION: us-east-1
  ENVIRONMENT: production

jobs:
  deploy-to-aws:
    runs-on: ubuntu-latest
    env:
      DEPLOYMENT_NAME: mechanic-management-demo
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Print Workflow Env
        run: |
          echo "Workflow-level: AWS_REGION=$AWS_REGION"
          echo "Workflow-level: ENVIRONMENT=$ENVIRONMENT"

      - name: Print Job Env
        run: |
          echo "Job-level: DEPLOYMENT_NAME=$DEPLOYMENT_NAME"

      - name: Access AWS Secrets
        env:
          AWS_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        run: |
          echo "AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY are set (masked)."

      - name: Step-Level Env Example
        env:
          STEP_VAR: hello_step
        run: |
          echo "Step-level variable: $STEP_VAR"
          echo "Workflow-level var still available: $ENVIRONMENT"
